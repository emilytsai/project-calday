<!DOCTYPE html>
<html lang="en">

<head>
  <script data-require="jquery@*" data-semver="2.0.3" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore.js"></script>
  <script src="//maps.google.com/maps/api/js?v=3.18&sensor=false&client=&key=&libraries=geometry&language=&hl=&region="></script>
  <script src="//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js"></script>
  <script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js' type='text/javascript'></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/gmaps4rails/2.1.2/gmaps4rails.js"></script>
</head>

<body>

<div class="container theme-showcase" role="main">
  <div class="jumbotron">
  <h1 style="text-align: center;">Welcome to Cal Day!</h1>

	<% if not current_organization and not current_student and not current_leader %>
		<div class="row">
      <div class="col-md-6" style="text-align: center;">
        <h2>Sign Up</h2>
        <h3>I am a(n):</h3>
      	<p><%= button_to "Student", new_student_registration_path, :class => "btn btn-lg btn-default", :method => :get %></p>
      	<p><%= button_to "Organization", new_organization_registration_path, :class => "btn btn-lg btn-default", :method => :get %></p>
        <p><%= button_to "Group Leader", new_leader_registration_path, :class => "btn btn-lg btn-default", :method => :get %></p>
    	</div><!-- /.col-sm-4 -->
      
      <div class="col-md-6" style="text-align: center;">
        <h2>Sign In</h2>
        <h3>I am a(n):</h3>
        <p><%= button_to "Student", new_student_session_path, :class => "btn btn-lg btn-default", :method => :get %></p>
        <p><%= button_to "Organization", new_organization_session_path, :class => "btn btn-lg btn-default", :method => :get %></p>
        <p><%= button_to "Group Leader", new_leader_session_path, :class => "btn btn-lg btn-default", :method => :get %></p>
      </div><!-- /.col-sm-4 -->
    </div>
	<% end %> 	
	<% if current_student or current_organization or current_leader %>
		<h2>All Events:</h2>
		<% @events.each do |f| %>
      <h3><%= f.title + " | " + Organization.find(f.organization).name %></h3>
		<% end %>
    <hr>
    <div style="width: 800px;">
      <div id="map" style="width: 100%; height: 500px;"></div>
    </div>
    <script type="text/javascript">
      var handler = Gmaps.build('Google');
      handler.buildMap({ provider: {disableDefaultUI: true }, internal: {id: 'map'}}, function(){
        var json = [
          {"lat":37.8750,"lng":-122.2545, infowindow: 'HKN Hackathon' },
          {"lat":37.8710,"lng":-122.2591, infowindow: 'HKN Presentation' },
          {"lat":37.8680,"lng":-122.2660, infowindow: 'DWX Showcase' }
        ];
        <% @events.each do |f| %>
          var data = {
          "lat": ${f.latitude},
          "lng": ${f.longitude},
          infowindow: ${f.title}
          };
          json.push(data);
        <% end %>
        markers = handler.addMarkers(json);
        handler.bounds.extendWith(markers);
        _.each(markers, function(marker){
          google.maps.event.trigger(marker.getServiceObject(), 'click');
        });
        handler.fitMapToBounds();     
      });
    </script>

	<% end %>

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="js/bootstrap.min.js"></script>
  </div>
</div>

</body>
